(define abre-arquivo (open-input-file "../testes/b"))
;(read-line in)
;(define linha (read-line in))
(define linha (read-line abre-arquivo))

(define (arquivo-convertido-em-lista ponteiro linha)
  (cond
    [(eof-object? linha) empty]
    [else (cons (converte-em-lista (string-split linha " ")) (arquivo-convertido-em-lista ponteiro (read-line ponteiro)))]))

(define (converte-em-lista dia)
  (cond
    [(empty? dia) empty]
    [(= 3 (string-length (first dia))) (cons (first dia) (converte-em-lista (rest dia)))]
    [else (cons (transforma-intervalo (first dia)) (converte-em-lista (rest dia)))]))

(define (transforma-intervalo palavra)
  (let ([hora-inicial (transforma-horario (string-split (first (string-split palavra "-"))":"))]
        [hora-final   (transforma-horario (string-split (first (rest (string-split palavra "-")))":"))])
    (intervalo hora-inicial hora-final))) 

(define (transforma-horario palavra)
  (cond
    [(empty? palavra) empty]
    [else
     (let ([hora   (string->number (first palavra ))]
           [minuto (string->number (first(rest palavra )))])
       (horario hora minuto))]))

(define lista-importada (arquivo-convertido-em-lista abre-arquivo linha))
;; variavel lista-importada est√° o arquivo importado
